# Sample flask Hello World app with CI (GitHub Actions) and offline installer .

## Overview

This project provides a fully offline installer for a minimal Flask "Hello World" app, packaged in a Docker container. It is designed for environments without internet access and supports Ubuntu/Debian systems.

## Directory Structure

- `src/helloworld-app/`
  - `Dockerfile` — Defines the Flask Hello World container (Python/Flask on Alpine)
  - `app.py` — Minimal Flask app serving 'Hello World' on port 8090
  - `helloworld-image.tar` — (Optional) Pre-built Docker image for offline loading
- `offline-packages/` — Place all required Docker `.deb` packages here for offline install
- `makeself/` — Local makeself scripts (required for packaging)
- `install-dependencies.sh` — Installs makeself and Docker (offline, for Ubuntu/Debian)
- `install-hello-world.sh` — Loads and runs the Flask Docker container on port 8090
- `package-with-makeself.sh` — Packages the entire project into a self-extracting archive
- `hello-world-installer.run` — Self-extracting installer (generated by makeself)
- `.github/workflows/ci.yml` — GitHub Actions workflow for CI/CD
- `.gitignore` — Excludes build artifacts and temp files from version control

## Quickstart

### 1. Prepare Docker Offline Packages

On a machine with internet access, download the official Docker CE `.deb` files and all their dependencies for your Ubuntu/Debian version and architecture from:

```
https://download.docker.com/linux/ubuntu/dists/$(lsb_release -cs)/pool/stable/$(dpkg --print-architecture)/ 
```

Required packages include:
- `containerd.io_<version>_<arch>.deb`
- `docker-ce_<version>_<arch>.deb`
- `docker-ce-cli_<version>_<arch>.deb`
- `docker-buildx-plugin_<version>_<arch>.deb`
- `docker-compose-plugin_<version>_<arch>.deb`

Download all dependencies for these packages as well (using `apt-rdepends` and `apt-get download` on a similar system is recommended). Place **all** `.deb` files in the `offline-packages/` directory in the project root.

### 2. Install Dependencies and Docker Offline

```sh
sudo bash install-dependencies.sh
```
- Installs all `.deb` files from `offline-packages/` and fixes dependencies using only local files.
- Installs `makeself` if needed.

### 3. Build or Load the Docker Image

- **If you have `helloworld-image.tar`:**
  ```sh
  sudo bash install-hello-world.sh
  ```
  This will load the image and run the container.

- **If you do not have `helloworld-image.tar`:**
  The script will build the image from `src/helloworld-app/Dockerfile` and run it.

The app will be available at [http://localhost:8090/](http://localhost:8090/)

### 4. (Optional) Build Docker Image and Save for Offline Use

If you want to create a new image tarball for offline use:

```sh
cd src/helloworld-app
sudo docker build --platform=linux/amd64 -t hello-world:local .
sudo docker save hello-world:local -o helloworld-image.tar
```

### 5. Package the Project for Offline Distribution

```sh
sudo bash package-with-makeself.sh
```
- This creates `hello-world-installer.run` containing all project files for offline use.

### 6. Use the Self-Extracting Installer (Offline)

```sh
sudo ./hello-world-installer.run
```
- Extracts all project files for offline setup and use.

## CI/CD

- The project uses GitHub Actions (`.github/workflows/ci.yml`) to:
  - Lint shell scripts with ShellCheck
  - Spell check documentation and scripts with cspell
  - Build and test the Docker image
  - Package the project with makeself
  - Upload the offline installer as a workflow artifact

## Spell Checking Configuration

- The workflow uses [cspell](https://cspell.org/) for spell checking.
- You can customize spell checking by editing or adding a `cspell.json` file in the project root.
- If no `cspell.json` is present, cspell will use its default settings.

## Troubleshooting

- If a script fails, check for missing files, permissions, or missing dependencies.
- For CI failures, review the Actions tab on GitHub for detailed logs.
- If spell checking fails, ensure you have a valid `cspell.json` or adjust the workflow to use cspell defaults.
- For Docker issues, ensure your offline packages are complete and compatible with your OS version.

## Requirements

- Ubuntu/Debian system (for offline Docker install logic)
- All files must be present in the same directory for offline use
- Docker CE `.deb` packages in `offline-packages/`
- The Flask app runs on port 8090 by default

## Notes

- Run all scripts as root (use `sudo`).
- The project is designed for full offline use, including Docker and all dependencies.
- For any issues, check the script output for missing files or permissions.